test:
    override:
        - cd ../testproject && mbed compile -m K64F -t GCC_ARM --source=. --source=mbed-os/TESTS/integration/basic
        - cd ../testproject && mbed test --compile -m K64F -t GCC_ARM
        - cd ../testproject && mbed test --compile -m LPC1768 -t GCC_ARM
        - cd ../testproject && mbed test --compile -m NRF51_DK -t GCC_ARM

dependencies:
    pre:
        - git fetch origin master
        - git checkout -b pr-branch
        - git checkout origin/master
        - git merge pr-branch --no-commit
        - cd ../ && ls
        - cd ../ && git clone https://github.com/ARMmbed/mbed-cli.git
        - cd ../mbed-cli && sudo pip install -e .
        - cd ../ && mkdir testproject
        - cd ../ && cp -r mbed-os testproject
        - cd ../testproject && git init
        - sudo add-apt-repository -y ppa:terry.guo/gcc-arm-embedded
        - sudo apt-get -y update
        - sudo apt-get -y install gcc-arm-none-eabi=4.9.3.2015q3-1precise1
    override:
        - cd ../testproject && mbed deploy
        - cd ../testproject/mbed-os/core && sudo pip install -r requirements.txt
